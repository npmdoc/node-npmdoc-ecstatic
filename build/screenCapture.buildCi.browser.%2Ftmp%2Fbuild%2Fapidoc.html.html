<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/jfhbrook/node-ecstatic">ecstatic (v2.1.0)</a>
</h1>
<h4>A simple static file server middleware that works with both Express and Flatiron</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.ecstatic">module ecstatic</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.ecstatic">
            function <span class="apidocSignatureSpan"></span>ecstatic
            <span class="apidocSignatureSpan">(dir, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.showDir">
            function <span class="apidocSignatureSpan">ecstatic.</span>showDir
            <span class="apidocSignatureSpan">(opts, stat)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">ecstatic.</span>status_handlers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">ecstatic.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.ecstatic.status_handlers">module ecstatic.status_handlers</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.304">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>304
            <span class="apidocSignatureSpan">(res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.400">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>400
            <span class="apidocSignatureSpan">(res, next, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.403">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>403
            <span class="apidocSignatureSpan">(res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.404">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>404
            <span class="apidocSignatureSpan">(res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.405">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>405
            <span class="apidocSignatureSpan">(res, next, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.416">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>416
            <span class="apidocSignatureSpan">(res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ecstatic.status_handlers.500">
            function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>500
            <span class="apidocSignatureSpan">(res, next, opts)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.ecstatic" id="apidoc.module.ecstatic">module ecstatic</a></h1>


    <h2>
        <a href="#apidoc.element.ecstatic.ecstatic" id="apidoc.element.ecstatic.ecstatic">
        function <span class="apidocSignatureSpan"></span>ecstatic
        <span class="apidocSignatureSpan">(dir, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ecstatic = function (dir, options) {
  if (typeof dir !== 'string') {
    options = dir;
    dir = options.root;
  }

  var root = path.join(path.resolve(dir), '/'),
      opts = optsParser(options),
      cache = opts.cache,
      autoIndex = opts.autoIndex,
      baseDir = opts.baseDir,
      defaultExt = opts.defaultExt,
      handleError = opts.handleError,
      headers = opts.headers,
      serverHeader = opts.serverHeader,
      weakEtags = opts.weakEtags,
      handleOptionsMethod = opts.handleOptionsMethod;

  opts.root = dir;
  if (defaultExt &amp;&amp; /^\./.test(defaultExt)) defaultExt = defaultExt.replace(/^\./, '');

  // Support hashes and .types files in mimeTypes @since 0.8
  if (opts.mimeTypes) {
    try {
      // You can pass a JSON blob here---useful for CLI use
      opts.mimeTypes = JSON.parse(opts.mimeTypes);
    } catch (e) {}
    if (typeof opts.mimeTypes === 'string') {
      mime.load(opts.mimeTypes);
    }
    else if (typeof opts.mimeTypes === 'object') {
      mime.define(opts.mimeTypes);
    }
  }


  return function middleware (req, res, next) {

    // Strip any null bytes from the url
    // This was at one point necessary because of an old bug in url.parse
    //
    // See: https://github.com/jfhbrook/node-ecstatic/issues/16#issuecomment-3039914
    // See: https://github.com/jfhbrook/node-ecstatic/commit/43f7e72a31524f88f47e367c3cc3af710e67c9f4
    //
    // But this opens up a regex dos attack vector! D:
    //
    // Based on some research (ie asking #node-dev if this is still an issue),
    // it's *probably* not an issue. :)
<span class="apidocCodeCommentSpan">    /*
    while(req.url.indexOf('%00') !== -1) {
      req.url = req.url.replace(/\%00/g, '');
    }
    */
</span>
    // Figure out the path for the file from the given url
    var parsed = url.parse(req.url);
    try {
      decodeURIComponent(req.url); // check validity of url
      var pathname = decodePathname(parsed.pathname);
    }
    catch (err) {
      return status[400](res, next, { error: err });
    }

    var file = path.normalize(
          path.join(root,
            path.relative(
              path.join('/', baseDir),
              pathname
            )
          )
        ),
        gzipped = file + '.gz';

    if(serverHeader !== false) {
      // Set common headers.
      res.setHeader('server', 'ecstatic-'+version);
    }
    Object.keys(headers).forEach(function (key) {
      res.setHeader(key, headers[key])
    })

    if (req.method === 'OPTIONS' &amp;&amp; handleOptionsMethod) {
      return res.end();
    }

    // TODO: This check is broken, which causes the 403 on the
    // expected 404.
    if (file.slice(0, root.length) !== root) {
      return status[403](res, next);
    }

    if (req.method &amp;&amp; (req.method !== 'GET' &amp;&amp; req.method !== 'HEAD' )) {
      return status[405](res, next);
    }

    function statFile() {
      fs.stat(file, function (err, stat) {
        if (err &amp;&amp; (err.code === 'ENOENT' || err.code === 'ENOTDIR')) {
          if (req.statusCode == 404) {
            // This means we're already trying ./404.html and can not find it.
            // So send plain text response with 404 status code
            status[404](res, next);
          }
          else if (!path.extname(parsed.pathname).length &amp;&amp; defaultExt) {
            // If there is no file extension in the path and we have a default
            // extension try filename and default extension combination before rendering 404.html.
            middleware({
              url: parsed.pathname + '.' + defaultExt + ((parsed.search)? parsed.search:'')
            }, res, next);
          }
          else {
            // Try to serve default ./404.html
            middleware({
              url: (handleError ? ('/' + path.join(baseDir, '404.' + defaultExt)) : req.url),
              statusCode: 404
            }, res, next);
          }
        }
        else if (err) {
          status[500](res, next, { error: err });
        }
        else if (stat.isDirectory()) {
          if (!autoIndex &amp;&amp; !opts.showDir) {
            status[404](res, next);
            return;
          }

          // 3 ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.showDir" id="apidoc.element.ecstatic.showDir">
        function <span class="apidocSignatureSpan">ecstatic.</span>showDir
        <span class="apidocSignatureSpan">(opts, stat)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">showDir = function (opts, stat) {
  // opts are parsed by opts.js, defaults already applied
  var cache = opts.cache,
      root = path.resolve(opts.root),
      baseDir = opts.baseDir,
      humanReadable = opts.humanReadable,
      handleError = opts.handleError,
      showDotfiles = opts.showDotfiles,
      si = opts.si,
      weakEtags = opts.weakEtags;

  return function middleware (req, res, next) {

    // Figure out the path for the file from the given url
    var parsed = url.parse(req.url),
        pathname = decodeURIComponent(parsed.pathname),
        dir = path.normalize(
          path.join(root,
            path.relative(
              path.join('/', baseDir),
              pathname
            )
          )
        );

    fs.stat(dir, function (err, stat) {
      if (err) {
        return handleError ? status[500](res, next, { error: err }) : next();
      }

      // files are the listing of dir
      fs.readdir(dir, function (err, files) {
        if (err) {
          return handleError ? status[500](res, next, { error: err }) : next();
        }

        // Optionally exclude dotfiles from directory listing.
        if (!showDotfiles) {
          files = files.filter(function(filename){
            return filename.slice(0,1) !== '.';
          });
        }

        res.setHeader('content-type', 'text/html');
        res.setHeader('etag', etag(stat, weakEtags));
        res.setHeader('last-modified', (new Date(stat.mtime)).toUTCString());
        res.setHeader('cache-control', cache);

        sortFiles(dir, files, function (lolwuts, dirs, files) {
          // It's possible to get stat errors for all sorts of reasons here.
          // Unfortunately, our two choices are to either bail completely,
          // or just truck along as though everything's cool. In this case,
          // I decided to just tack them on as "??!?" items along with dirs
          // and files.
          //
          // Whatever.

          // if it makes sense to, add a .. link
          if (path.resolve(dir, '..').slice(0, root.length) == root) {
            return fs.stat(path.join(dir, '..'), function (err, s) {
              if (err) {
                return handleError ? status[500](res, next, { error: err }) : next();
              }
              dirs.unshift([ '..', s ]);
              render(dirs, files, lolwuts);
            });
          }
          render(dirs, files, lolwuts);
        });

        function render(dirs, files, lolwuts) {
          // each entry in the array is a [name, stat] tuple

          var html = [
            '&lt;!doctype html&gt;',
            '&lt;html&gt;',
            '  &lt;head&gt;',
            '    &lt;meta charset="utf-8"&gt;',
            '    &lt;meta name="viewport" content="width=device-width"&gt;',
            '    &lt;title&gt;Index of ' + he.encode(pathname) +'&lt;/title&gt;',
            '    &lt;style type="text/css"&gt;' + css + '&lt;/style&gt;',
            '  &lt;/head&gt;',
            '  &lt;body&gt;',
            '&lt;h1&gt;Index of ' + he.encode(pathname) + '&lt;/h1&gt;'
          ].join('\n') + '\n';

          html += '&lt;table&gt;';

          var failed = false;
          var writeRow = function (file, i) {
            // render a row given a [name, stat] tuple
            var isDir = file[1].isDirectory &amp;&amp; file[1].isDirectory();
            var href = parsed.pathname.replace(/\/$/, '') + '/' + encodeURIComponent(file[0]);

            // append trailing slash and query for dir entry
            if (isDir) {
              href += '/' + he.encode((parsed.search)? parsed.search:'');
            }

            var displayName = he.encode(file[0]) + ((isDir)? '/':'');

            var ext = file[0].split('.').pop();

            var iconClass = 'icon-' + (isDir ? '_blank' : (supportedIcons[ext] ? ext : '_page'));

            // TODO: use stylessheets?
            html += '&lt;tr&gt;' +
              '&lt;td class="icon-parent"&gt;&lt;i class="' + iconClass + '"&gt;&lt;/i&gt;&lt;/td&gt;' +
              '&lt;td class="perms"&gt;&lt;code&gt;(' + permsToString(file[1]) + ')&lt;/code&gt;&lt;/td&gt;' +
              '&lt;td class="file-size"&gt;&lt;code&gt;' + sizeToString(file[1], humanReadable, si) + '&lt;/code&gt;&lt;/td&gt;' + ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Defaults to **false**.

## middleware(req, res, next);

This works more or less as you'd expect.

### ecstatic.<span class="apidocCodeKeywordSpan">showDir</span>(folder);

This returns another middleware which will attempt to show a directory view. Turning on auto-indexing is roughly equivalent to adding
 this middleware after an ecstatic middleware with autoindexing disabled.

### `ecstatic` command

to start a standalone static http server,
run `npm install -g ecstatic` and then run `ecstatic [dir?] [options] --port PORT`
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.ecstatic.status_handlers" id="apidoc.module.ecstatic.status_handlers">module ecstatic.status_handlers</a></h1>


    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.304" id="apidoc.element.ecstatic.status_handlers.304">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>304
        <span class="apidocSignatureSpan">(res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">304 = function (res, next) {
  res.statusCode = 304;
  res.end();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.400" id="apidoc.element.ecstatic.status_handlers.400">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>400
        <span class="apidocSignatureSpan">(res, next, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">400 = function (res, next, opts) {
  res.statusCode = 400;
  res.setHeader('content-type', 'text/html');
  var error = opts &amp;&amp; opts.error ? String(opts.error) : 'Malformed request.',
      html = [
    '&lt;!doctype html&gt;',
    '&lt;html&gt;',
    '  &lt;head&gt;',
    '    &lt;meta charset="utf-8"&gt;',
    '    &lt;title&gt;400 Bad Request&lt;/title&gt;',
    '  &lt;/head&gt;',
    '  &lt;body&gt;',
    '    &lt;p&gt;',
    '      ' + he.encode(error),
    '    &lt;/p&gt;',
    '  &lt;/body&gt;',
    '&lt;/html&gt;'
  ].join('\n') + '\n';
  res.end(html);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.403" id="apidoc.element.ecstatic.status_handlers.403">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>403
        <span class="apidocSignatureSpan">(res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">403 = function (res, next) {
  res.statusCode = 403;
  if (typeof next === "function") {
    next();
  }
  else {
    if (res.writable) {
      res.setHeader('content-type', 'text/plain');
      res.end('ACCESS DENIED');
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.404" id="apidoc.element.ecstatic.status_handlers.404">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>404
        <span class="apidocSignatureSpan">(res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">404 = function (res, next) {
  res.statusCode = 404;
  if (typeof next === "function") {
    next();
  }
  else {
    if (res.writable) {
      res.setHeader('content-type', 'text/plain');
      res.end('File not found. :(');
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.405" id="apidoc.element.ecstatic.status_handlers.405">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>405
        <span class="apidocSignatureSpan">(res, next, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">405 = function (res, next, opts) {
  res.statusCode = 405;
  if (typeof next === "function") {
    next();
  }
  else {
    res.setHeader('allow', (opts &amp;&amp; opts.allow) || 'GET, HEAD');
    res.end();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.416" id="apidoc.element.ecstatic.status_handlers.416">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>416
        <span class="apidocSignatureSpan">(res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">416 = function (res, next) {
  res.statusCode = 416;
  if (typeof next === "function") {
    next();
  }
  else {
    if (res.writable) {
      res.setHeader('content-type', 'text/plain');
      res.end('Requested range not satisfiable');
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.ecstatic.status_handlers.500" id="apidoc.element.ecstatic.status_handlers.500">
        function <span class="apidocSignatureSpan">ecstatic.status_handlers.</span>500
        <span class="apidocSignatureSpan">(res, next, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">500 = function (res, next, opts) {
  res.statusCode = 500;
  res.setHeader('content-type', 'text/html');
  var error = String(opts.error.stack || opts.error || "No specified error"),
      html = [
    '&lt;!doctype html&gt;',
    '&lt;html&gt;',
    '  &lt;head&gt;',
    '    &lt;meta charset="utf-8"&gt;',
    '    &lt;title&gt;500 Internal Server Error&lt;/title&gt;',
    '  &lt;/head&gt;',
    '  &lt;body&gt;',
    '    &lt;p&gt;',
    '      ' + he.encode(error),
    '    &lt;/p&gt;',
    '  &lt;/body&gt;',
    '&lt;/html&gt;'
  ].join('\n') + '\n';
  res.end(html);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>